import{E as d,a7 as b,ab as l,a8 as v,M as _,a0 as u,H as o,Z as m,ak as k,a1 as g,O as T,T as y,al as E,V as A,W as M,X as w,Q as F,Y as p}from"./yF9IpEO4.js";class R{anchor;#t=new Map;#s=new Map;#e=new Map;#a=!0;constructor(s,r=!0){this.anchor=s,this.#a=r}#r=()=>{var s=d;if(this.#t.has(s)){var r=this.#t.get(s),t=this.#s.get(r);if(t)b(t);else{var c=this.#e.get(r);c&&(this.#s.set(r,c.effect),this.#e.delete(r),c.fragment.lastChild.remove(),this.anchor.before(c.fragment),t=c.effect)}for(const[i,e]of this.#t){if(this.#t.delete(i),i===s)break;const a=this.#e.get(e);a&&(l(a.effect),this.#e.delete(e))}for(const[i,e]of this.#s){if(i===r)continue;const a=()=>{if(Array.from(this.#t.values()).includes(i)){var h=document.createDocumentFragment();k(e,h),h.append(_()),this.#e.set(i,{effect:e,fragment:h})}else l(e);this.#s.delete(i)};this.#a||!t?v(e,a,!1):a()}}};ensure(s,r){var t=d,c=g();if(r&&!this.#s.has(s)&&!this.#e.has(s))if(c){var i=document.createDocumentFragment(),e=_();i.append(e),this.#e.set(s,{effect:u(()=>r(e)),fragment:i})}else this.#s.set(s,u(()=>r(this.anchor)));if(this.#t.set(t,s),c){for(const[a,f]of this.#s)a===s?t.skipped_effects.delete(f):t.skipped_effects.add(f);for(const[a,f]of this.#e)a===s?t.skipped_effects.delete(f.effect):t.skipped_effects.add(f.effect);t.add_callback(this.#r)}else o&&(this.anchor=m),this.#r()}}function D(n,s,r=!1){o&&y();var t=new R(n),c=r?E:0;function i(e,a){if(o){const h=A(n)===M;if(e===h){var f=w();F(f),t.anchor=f,p(!1),t.ensure(e,a),p(!0);return}}t.ensure(e,a)}T(()=>{var e=!1;s((a,f=!0)=>{e=!0,i(f,a)}),e||i(!1,null)},c)}export{R as B,D as i};
