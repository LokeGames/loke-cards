import"./DsnmJJEf.js";import"./BnfXkLE3.js";import{H as Ce,T as Ne,p as T,aF as D,aG as re,f as S,t as E,a as b,c as F,h as Q,g as e,e as c,d as m,m as P,r as n,aE as w,s as y,aj as Le,u as te,n as j,b as ge}from"./yF9IpEO4.js";import{s as z,e as N,o as J}from"./CAKmdX18.js";import{p as G,s as K,a as A}from"./oaR_oenP.js";import{s as se}from"./4O88iP2y.js";import{s as U,g as Oe,a as Ae,c as Ee,b as Te}from"./DvVjvEKR.js";import{i as Z}from"./CiABMiT9.js";import{w as I,g as q}from"./CefW3WW4.js";import{i as oe}from"./SV0_QZCG.js";import{e as be,i as ye}from"./BW16Smnj.js";import{b as Fe}from"./D2rwkULN.js";function Ie(l,s,t,v,f){Ce&&Ne();var o=s.$$slots?.[t],u=!1;o===!0&&(o=s.children,u=!0),o===void 0||o(l,u?()=>v:v)}const ne=I(!1),Me=()=>{ne.update(l=>!l)},ae=()=>ne.set(!1),R=I("idle"),he=I(0),me=I(null),De=I(null);function ze(){R.set("offline")}function Ze(){R.set("synced"),me.set(Date.now())}function Ge(l){R.set(l)}var He=S("<span> </span>");function Re(l,s){T(s,!1);const t=()=>A(he,"$pending",u),v=()=>A(R,"$status",u),f=()=>A(me,"$lastSync",u),o=()=>A(De,"$error",u),[u,d]=K();let g=G(s,"state",8,void 0),r=P(),i=P(),h=P(),a=P(0);D(()=>t(),()=>{m(a,Number(t()||0))}),D(()=>(Q(g()),v()),()=>{m(r,g()||v()||"idle")}),D(()=>(e(r),e(a)),()=>{e(r)==="synced"?m(i,e(a)>0?`Pending ${e(a)}`:"Synced"):e(r)==="syncing"?m(i,e(a)>0?`Syncing… ${e(a)}`:"Syncing…"):e(r)==="offline"?m(i,"Offline"):e(r)==="error"?m(i,"Sync error"):m(i,e(a)>0?`Pending ${e(a)}`:"Idle")}),D(()=>(e(r),f(),o()),()=>{if(e(r)==="synced"&&f()){const k=new Date(f());m(h,`Last sync: ${k.toLocaleString()}`)}else e(r)==="error"&&o()?m(h,String(o())):m(h,"Sync status")}),re(),Z();var p=He();let x;var L=c(p,!0);n(p),E(k=>{x=U(p,1,"text-sm px-3 py-1 rounded-full text-white",null,x,k),se(p,"title",e(h)),z(L,e(i))},[()=>({"bg-green-500":e(r)==="synced","bg-blue-500":e(r)==="syncing","bg-yellow-500":e(r)==="idle","bg-red-500":e(r)==="error","bg-gray-500":e(r)==="offline"})]),b(l,p),F(),d()}var Be=S("<button><!></button>");function Qe(l,s){T(s,!1);const t=()=>q(R)!=="offline";function v(a){try{localStorage.setItem("LC_FORCE_OFFLINE",a?"1":"0")}catch{}a?ze():q(he)>0?Ge("idle"):Ze()}const f=()=>v(t()),o=()=>v(!1),u=()=>v(!0);if(typeof window<"u"){try{localStorage.getItem("LC_FORCE_OFFLINE")==="1"&&v(!0)}catch{}window.addEventListener("online",o),window.addEventListener("offline",u)}Z();var d=Be();let g;var r=c(d);{var i=a=>{var p=w("Online");b(a,p)},h=a=>{var p=w("Offline");b(a,p)};oe(r,a=>{t()?a(i):a(h,!1)})}n(d),E((a,p)=>{g=U(d,1,"inline-flex items-center gap-1 text-sm px-3 py-1 rounded-full border transition-colors",null,g,a),se(d,"aria-pressed",p)},[()=>({"!bg-emerald-600":t(),"!text-white":t(),"!border-emerald-700":t(),"hover:!bg-emerald-700":t(),"bg-gray-600":!t(),"text-white":!t(),"border-gray-700":!t(),"hover:bg-gray-700":!t()}),()=>!t()]),N("click",d,f),b(l,d),F()}var qe=S('<button class="px-2 py-1 rounded border border-gray-200 dark:border-gray-700" aria-label="Toggle theme"><!></button>');function Je(l,s){T(s,!1);let t=P(!1);const v=()=>{if(!(typeof document>"u")){document.documentElement.classList.toggle("dark",e(t));try{localStorage.theme=e(t)?"dark":"light"}catch{}}};J(()=>{try{m(t,localStorage.theme==="dark"||!("theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches)}catch{}v()});const f=()=>{m(t,!e(t)),v()};Z();var o=qe(),u=c(o);{var d=r=>{var i=w("🌙");b(r,i)},g=r=>{var i=w("☀️");b(r,i)};oe(u,r=>{e(t)?r(d):r(g,!1)})}n(o),N("click",o,f),b(l,o),F()}const B=I(null),H=I([]);async function Ke(){const l=await Oe();B.set(l);const s=new Map;l&&s.set(l.id,l),H.set(Array.from(s.values()))}async function pe(l){const t=q(H).find(v=>v.id===l)||null;t&&B.set(t)}async function Ue(l){const s={id:l.toLowerCase().replace(/\s+/g,"-"),name:l,chapters:[],sceneCount:0,createdAt:Date.now(),updatedAt:Date.now()};await Ae(s);const t=q(H);return H.set([...t,s]),B.set(s),s}var Ve=S("<option> </option>"),We=S('<div class="flex items-center gap-2"><label class="text-xs text-gray-500 dark:text-gray-400" for="project-picker">Project</label> <select id="project-picker" class="px-2 py-1 text-sm rounded border border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-900 text-gray-800 dark:text-gray-100"></select> <button class="px-2 py-1 text-sm rounded bg-blue-600 hover:bg-blue-700 text-white" title="New project" aria-label="New project">+</button></div>');function Xe(l,s){T(s,!1);const t=()=>A(B,"$currentProject",f),v=()=>A(H,"$projects",f),[f,o]=K();J(()=>{t()||Ke()});let u=P("");const d=a=>pe(a.target.value),g=async()=>{const a=window.prompt("New project name:");if(!a||!a.trim())return;const p=await Ue(a.trim());await pe(p.id)};D(()=>t(),()=>{m(u,t()?.id||"default")}),re(),Z();var r=We(),i=y(c(r),2);E(()=>{e(u),Le(()=>{v()})}),be(i,5,v,ye,(a,p)=>{var x=Ve(),L=c(x,!0);n(x);var k={};E(()=>{z(L,(e(p),te(()=>e(p).name||e(p).id))),k!==(k=(e(p),te(()=>e(p).id)))&&(x.value=(x.__value=(e(p),te(()=>e(p).id)))??"")}),b(a,x)}),n(i);var h=y(i,2);n(r),Fe(i,()=>e(u),a=>m(u,a)),N("change",i,d),N("click",h,g),b(l,r),F(),o()}var Ye=S('<header class="sticky top-0 z-30 flex items-center justify-between gap-3 px-4 py-2 border-b border-gray-200 dark:border-gray-700 bg-white/80 dark:bg-gray-900/80 backdrop-blur supports-[backdrop-filter]:bg-white/60 dark:supports-[backdrop-filter]:bg-gray-900/60"><button class="md:hidden p-2 rounded hover:bg-gray-100 dark:hover:bg-gray-800" aria-label="Toggle menu"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6"><path fill-rule="evenodd" d="M3.75 5.25a.75.75 0 0 1 .75-.75h15a.75.75 0 0 1 0 1.5h-15a.75.75 0 0 1-.75-.75Zm0 6.75a.75.75 0 0 1 .75-.75h15a.75.75 0 0 1 0 1.5h-15a.75.75 0 0 1-.75-.75Zm0 6.75a.75.75 0 0 1 .75-.75h15a.75.75 0 0 1 0 1.5h-15a.75.75 0 0 1-.75-.75Z" clip-rule="evenodd"></path></svg></button> <h1 class="text-lg font-semibold text-gray-900 dark:text-gray-100"> </h1> <div class="ml-auto flex items-center gap-2"><!> <!> <!> <!></div></header>');function mt(l,s){let t=G(s,"title",8,"Loke Cards");var v=Ye(),f=c(v),o=y(f,2),u=c(o,!0);n(o);var d=y(o,2),g=c(d);Re(g,{});var r=y(g,2);Qe(r,{});var i=y(r,2);Xe(i,{});var h=y(i,2);Je(h,{}),n(d),n(v),E(()=>z(u,t())),N("click",f,function(...a){Me?.apply(this,a)}),b(l,v)}var et=S("<a><!></a>");function C(l,s){T(s,!1);const t=P(),v=P();let f=G(s,"to",8,"/"),o=G(s,"baseClass",8,"text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-800 px-3 py-2 rounded block"),u=G(s,"activeClass",8,"bg-gray-100 dark:bg-gray-800 text-gray-900 dark:text-white"),d=P("");typeof window<"u"&&m(d,window.location.pathname),D(()=>(e(d),Q(f())),()=>{m(t,e(d)===f())}),D(()=>(Q(o()),e(t),Q(u())),()=>{m(v,`nav-item ${o()} ${e(t)?u():""}`)}),re();var g=et(),r=c(g);Ie(r,s,"default",{}),n(g),E(()=>{se(g,"href",f()),U(g,1,Ee(e(v)))}),b(l,g),F()}var tt=S('<div><ul class="space-y-1 text-sm"><li><!></li> <li><!></li> <li><!></li> <li><!></li> <li><!></li> <li><!></li> <li><!></li></ul> <div class="mt-6 px-3"><h3 class="text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2">Project Info</h3> <div class="text-sm text-gray-700 dark:text-gray-300"><p class="font-semibold"> </p> <p> </p> <p> </p></div></div> <div class="mt-6 px-3"><h3 class="text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2">Quick Actions</h3> <ul class="space-y-1 text-sm"><li><!></li> <li><!></li></ul></div></div>');function fe(l,s){T(s,!1);const t=()=>A(B,"$currentProject",v),[v,f]=K();let o=P({scenes:0,chapters:0});J(async()=>{try{m(o,await Te())}catch{}}),Z();var u=tt(),d=c(u),g=c(d),r=c(g);C(r,{to:"/",children:(_,O)=>{j();var $=w("Dashboard");b(_,$)},$$slots:{default:!0}}),n(g);var i=y(g,2),h=c(i);C(h,{to:"/scenes",children:(_,O)=>{j();var $=w("Scenes");b(_,$)},$$slots:{default:!0}}),n(i);var a=y(i,2),p=c(a);C(p,{to:"/chapters",children:(_,O)=>{j();var $=w("Chapters");b(_,$)},$$slots:{default:!0}}),n(a);var x=y(a,2),L=c(x);C(L,{to:"/graph",children:(_,O)=>{j();var $=w("Graph");b(_,$)},$$slots:{default:!0}}),n(x);var k=y(x,2),M=c(k);C(M,{to:"/toc",children:(_,O)=>{j();var $=w("Story Map");b(_,$)},$$slots:{default:!0}}),n(k);var V=y(k,2),_e=c(V);C(_e,{to:"/code",children:(_,O)=>{j();var $=w("C code");b(_,$)},$$slots:{default:!0}}),n(V);var le=y(V,2),$e=c(le);C($e,{to:"/settings",children:(_,O)=>{j();var $=w("Settings");b(_,$)},$$slots:{default:!0}}),n(le),n(d);var W=y(d,2),ie=y(c(W),2),X=c(ie),we=c(X,!0);n(X);var Y=y(X,2),ke=c(Y);n(Y);var ce=y(Y,2),Se=c(ce);n(ce),n(ie),n(W);var de=y(W,2),ve=y(c(de),2),ee=c(ve),Pe=c(ee);C(Pe,{to:"/scene/new",class:"group flex items-center gap-2",children:(_,O)=>{j();var $=w("New Scene");b(_,$)},$$slots:{default:!0}}),n(ee);var ue=y(ee,2),je=c(ue);C(je,{to:"/chapter/new",class:"group flex items-center gap-2",children:(_,O)=>{j();var $=w("New Chapter");b(_,$)},$$slots:{default:!0}}),n(ue),n(ve),n(de),n(u),E(()=>{z(we,t()?.name||"No Project"),z(ke,`Scenes: ${e(o).scenes??""}`),z(Se,`Chapters: ${e(o).chapters??""}`)}),b(l,u),F(),f()}var at=S('<div class="md:hidden fixed inset-0 z-40 bg-black/40" role="button" tabindex="0" aria-label="Close menu overlay"></div> <aside class="md:hidden fixed z-50 inset-y-0 left-0 w-72 bg-white dark:bg-gray-900 border-r border-gray-200 dark:border-gray-700 p-3"><button class="mb-3 p-2 rounded hover:bg-gray-100 dark:hover:bg-gray-800" aria-label="Close menu">Close</button> <div class="text-sm text-gray-700 dark:text-gray-300"><!></div></aside>',1),rt=S('<aside class="hidden md:flex md:flex-col md:w-60 border-r border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-900"><div class="p-3 text-sm text-gray-700 dark:text-gray-300"><!></div> <div class="mt-auto p-3 text-xs text-gray-500">Sidebar</div></aside> <!>',1);function xt(l,s){T(s,!1);let t=P();const v=ne.subscribe(i=>m(t,i));J(()=>()=>v()),Z();var f=rt(),o=ge(f),u=c(o),d=c(u);fe(d,{}),n(u),j(2),n(o);var g=y(o,2);{var r=i=>{var h=at(),a=ge(h),p=y(a,2),x=c(p),L=y(x,2),k=c(L);fe(k,{}),n(L),n(p),N("click",a,function(...M){ae?.apply(this,M)}),N("keydown",a,M=>M.key==="Escape"&&ae()),N("click",x,function(...M){ae?.apply(this,M)}),b(i,h)};oe(g,i=>{e(t)&&i(r)})}b(l,f),F()}const xe=I([]);function st(l){xe.update(s=>s.filter(t=>t.id!==l))}var ot=S('<div><div class="flex items-start gap-2"><div class="flex-1"> </div> <button class="opacity-80 hover:opacity-100">×</button></div></div>'),nt=S('<div class="fixed z-50 bottom-4 right-4 space-y-2"></div>');function _t(l,s){T(s,!1);const t=()=>A(xe,"$toasts",v),[v,f]=K();Z();var o=nt();be(o,5,t,ye,(u,d)=>{var g=ot();let r;var i=c(g),h=c(i),a=c(h,!0);n(h);var p=y(h,2);n(i),n(g),E(x=>{r=U(g,1,"px-3 py-2 rounded shadow text-white",null,r,x),z(a,e(d).message)},[()=>({"bg-blue-600":e(d).type==="info","bg-green-600":e(d).type==="success","bg-yellow-600":e(d).type==="warn","bg-red-600":e(d).type==="error"})]),N("click",p,()=>st(e(d).id)),b(u,g)}),n(o),b(l,o),F(),f()}export{xt as A,mt as a,_t as b,Ie as s};
