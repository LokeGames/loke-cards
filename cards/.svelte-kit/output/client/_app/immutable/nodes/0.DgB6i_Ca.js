import"../chunks/DsnmJJEf.js";import"../chunks/C5HDdxh5.js";import{w as ee,s as D,g as fe,o as Q,e as L}from"../chunks/D_FywxHd.js";import{a3 as Pe,ax as je,a9 as Ce,J as Ne,b6 as Ae,b7 as Le,E as V,a6 as Te,p as Z,b8 as q,b9 as te,f as k,i as I,a as m,c as z,a0 as J,g as t,d as i,e as _,m as S,r,s as g,ba as Me,Z as X,n as P,t as C,b as ce}from"../chunks/B8En_kGa.js";import{d as qe,e as De,c as ge,f as Ie}from"../chunks/DtElN43D.js";import{i as E}from"../chunks/AZkGX8EF.js";import{p as O,s as W,a as A}from"../chunks/C-i4I0Wt.js";import{b as ae,s as pe,c as Ze}from"../chunks/Bv5GXq8d.js";import{s as ze,e as Ee,l as Oe,p as Be,N as Fe,T as He}from"../chunks/BORmlV8D.js";import{e as be,i as ye}from"../chunks/C_aHrBlA.js";import{i as Je}from"../chunks/Dtsh_00A.js";import{g as Qe}from"../chunks/R5IzP5HU.js";import{t as We,r as Ge}from"../chunks/DY7ZBqxn.js";function me(e,a,n=!1){if(e.multiple){if(a==null)return;if(!Ne(a))return Ae();for(var l of e.options)l.selected=a.includes(B(l));return}for(l of e.options){var c=B(l);if(Le(c,a)){l.selected=!0;return}}(!n||a!==void 0)&&(e.selectedIndex=-1)}function Ke(e){var a=new MutationObserver(()=>{me(e,e.__value)});a.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),Ce(()=>{a.disconnect()})}function Re(e,a,n=a){var l=new WeakSet,c=!0;Pe(e,"change",s=>{var v=s?"[selected]":":checked",d;if(e.multiple)d=[].map.call(e.querySelectorAll(v),B);else{var p=e.querySelector(v)??e.querySelector("option:not([disabled])");d=p&&B(p)}n(d),V!==null&&l.add(V)}),je(()=>{var s=a();if(e===document.activeElement){var v=Te??V;if(l.has(v))return}if(me(e,s,c),c&&s===void 0){var d=e.querySelector(":checked");d!==null&&(s=B(d),n(s))}e.__value=s,c=!1}),Ke(e)}function B(e){return"__value"in e?e.__value:e.value}const re=ee(!1),Ue=()=>{re.update(e=>!e)},Y=()=>re.set(!1);var Ve=k("<span> </span>");function Xe(e,a){Z(a,!1);const n=()=>A(Be,"$pending",v),l=()=>A(ze,"$status",v),c=()=>A(Oe,"$lastSync",v),s=()=>A(Ee,"$error",v),[v,d]=W();let p=O(a,"state",8,void 0),o=S(),u=S(),y=S(),f=S(0);q(()=>n(),()=>{_(f,Number(n()||0))}),q(()=>(J(p()),l()),()=>{_(o,p()||l()||"idle")}),q(()=>(t(o),t(f)),()=>{t(o)==="synced"?_(u,t(f)>0?`Pending ${t(f)}`:"Synced"):t(o)==="syncing"?_(u,t(f)>0?`Syncing… ${t(f)}`:"Syncing…"):t(o)==="offline"?_(u,"Offline"):t(o)==="error"?_(u,"Sync error"):_(u,t(f)>0?`Pending ${t(f)}`:"Idle")}),q(()=>(t(o),c(),s()),()=>{if(t(o)==="synced"&&c()){const w=new Date(c());_(y,`Last sync: ${w.toLocaleString()}`)}else t(o)==="error"&&s()?_(y,String(s())):_(y,"Sync status")}),te(),E();var b=Ve();let x;var j=i(b,!0);r(b),I(w=>{x=ae(b,1,"text-sm px-3 py-1 rounded-full text-white",null,x,w),pe(b,"title",t(y)),D(j,t(u))},[()=>({"bg-green-500":t(o)==="synced","bg-blue-500":t(o)==="syncing","bg-yellow-500":t(o)==="idle","bg-red-500":t(o)==="error","bg-gray-500":t(o)==="offline"})]),m(e,b),z(),d()}const H=ee(null),F=ee([]);async function xe(){const e=await qe();H.set(e);const a=new Map;e&&a.set(e.id,e),F.set(Array.from(a.values()))}async function ve(e){const n=fe(F).find(l=>l.id===e)||null;n&&H.set(n)}async function Ye(e){const a={id:e.toLowerCase().replace(/\s+/g,"-"),name:e,chapters:[],sceneCount:0,createdAt:Date.now(),updatedAt:Date.now()};await De(a);const n=fe(F);return F.set([...n,a]),H.set(a),a}var et=k("<option> </option>"),tt=k('<div class="flex items-center gap-2"><label class="text-xs text-gray-500 dark:text-gray-400" for="project-picker">Project</label> <select id="project-picker" class="px-2 py-1 text-sm rounded border border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-900 text-gray-800 dark:text-gray-100"></select> <button class="px-2 py-1 text-sm rounded bg-blue-600 hover:bg-blue-700 text-white" title="New project" aria-label="New project">+</button></div>');function at(e,a){Z(a,!1);const n=()=>A(H,"$currentProject",c),l=()=>A(F,"$projects",c),[c,s]=W();Q(()=>{n()||xe()});let v=S("");const d=f=>ve(f.target.value),p=async()=>{const f=window.prompt("New project name:");if(!f||!f.trim())return;const b=await Ye(f.trim());await ve(b.id)};q(()=>n(),()=>{_(v,n()?.id||"default")}),te(),E();var o=tt(),u=g(i(o),2);I(()=>{t(v),Me(()=>{l()})}),be(u,5,l,ye,(f,b)=>{var x=et(),j=i(x,!0);r(x);var w={};I(()=>{D(j,(t(b),X(()=>t(b).name||t(b).id))),w!==(w=(t(b),X(()=>t(b).id)))&&(x.value=(x.__value=(t(b),X(()=>t(b).id)))??"")}),m(f,x)}),r(u);var y=g(u,2);r(o),Re(u,()=>t(v),f=>_(v,f)),L("change",u,d),L("click",y,p),m(e,o),z(),s()}var rt=k('<header class="flex items-center justify-between gap-3 px-4 py-2 border-b border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-900"><button class="md:hidden p-2 rounded hover:bg-gray-100 dark:hover:bg-gray-800" aria-label="Toggle menu"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6"><path fill-rule="evenodd" d="M3.75 5.25a.75.75 0 0 1 .75-.75h15a.75.75 0 0 1 0 1.5h-15a.75.75 0 0 1-.75-.75Zm0 6.75a.75.75 0 0 1 .75-.75h15a.75.75 0 0 1 0 1.5h-15a.75.75 0 0 1-.75-.75Zm0 6.75a.75.75 0 0 1 .75-.75h15a.75.75 0 0 1 0 1.5h-15a.75.75 0 0 1-.75-.75Z" clip-rule="evenodd"></path></svg></button> <h1 class="text-lg font-semibold text-gray-900 dark:text-gray-100"> </h1> <div class="ml-auto flex items-center gap-2"><!> <!> <!> <!></div></header>');function st(e,a){let n=O(a,"title",8,"Loke Cards");var l=rt(),c=i(l),s=g(c,2),v=i(s,!0);r(s);var d=g(s,2),p=i(d);Xe(p,{});var o=g(p,2);Fe(o,{});var u=g(o,2);at(u,{});var y=g(u,2);He(y,{}),r(d),r(l),I(()=>D(v,n())),L("click",c,function(...f){Ue?.apply(this,f)}),m(e,l)}var ot=k("<a><!></a>");function N(e,a){Z(a,!1);const n=S(),l=S();let c=O(a,"to",8,"/"),s=O(a,"baseClass",8,"text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-800 px-3 py-2 rounded block"),v=O(a,"activeClass",8,"bg-gray-100 dark:bg-gray-800 text-gray-900 dark:text-white"),d=S("");typeof window<"u"&&_(d,window.location.pathname);const p=y=>{y.preventDefault(),Qe(c())};q(()=>(t(d),J(c())),()=>{_(n,t(d)===c())}),q(()=>(J(s()),t(n),J(v())),()=>{_(l,`nav-item ${s()} ${t(n)?v():""}`)}),te(),E();var o=ot(),u=i(o);ge(u,a,"default",{}),r(o),I(()=>{pe(o,"href",c()),ae(o,1,Ze(t(l)))}),L("click",o,p),m(e,o),z()}var it=k('<div><ul class="space-y-1 text-sm"><li><!></li> <li><!></li> <li><!></li> <li><!></li> <li><!></li> <li><!></li></ul> <div class="mt-6 px-3"><h3 class="text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2">Project Info</h3> <div class="text-sm text-gray-700 dark:text-gray-300"><p class="font-semibold"> </p> <p> </p> <p> </p></div></div> <div class="mt-6 px-3"><h3 class="text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2">Quick Actions</h3> <ul class="space-y-1 text-sm"><li><!></li> <li><!></li></ul></div></div>');function ue(e,a){Z(a,!1);const n=()=>A(H,"$currentProject",l),[l,c]=W();let s=S({scenes:0,chapters:0});Q(async()=>{try{_(s,await Ie())}catch{}}),E();var v=it(),d=i(v),p=i(d),o=i(p);N(o,{to:"/",children:(h,M)=>{P();var $=C("Dashboard");m(h,$)},$$slots:{default:!0}}),r(p);var u=g(p,2),y=i(u);N(y,{to:"/scenes",children:(h,M)=>{P();var $=C("Scenes");m(h,$)},$$slots:{default:!0}}),r(u);var f=g(u,2),b=i(f);N(b,{to:"/chapters",children:(h,M)=>{P();var $=C("Chapters");m(h,$)},$$slots:{default:!0}}),r(f);var x=g(f,2),j=i(x);N(j,{to:"/toc",children:(h,M)=>{P();var $=C("Story Map");m(h,$)},$$slots:{default:!0}}),r(x);var w=g(x,2),T=i(w);N(T,{to:"/code",children:(h,M)=>{P();var $=C("C code");m(h,$)},$$slots:{default:!0}}),r(w);var se=g(w,2),_e=i(se);N(_e,{to:"/settings",children:(h,M)=>{P();var $=C("Settings");m(h,$)},$$slots:{default:!0}}),r(se),r(d);var G=g(d,2),oe=g(i(G),2),K=i(oe),he=i(K,!0);r(K);var R=g(K,2),$e=i(R);r(R);var ie=g(R,2),we=i(ie);r(ie),r(oe),r(G);var ne=g(G,2),le=g(i(ne),2),U=i(le),ke=i(U);N(ke,{to:"/scene/new",class:"group flex items-center gap-2",children:(h,M)=>{P();var $=C("New Scene");m(h,$)},$$slots:{default:!0}}),r(U);var de=g(U,2),Se=i(de);N(Se,{to:"/chapter/new",class:"group flex items-center gap-2",children:(h,M)=>{P();var $=C("New Chapter");m(h,$)},$$slots:{default:!0}}),r(de),r(le),r(ne),r(v),I(()=>{D(he,n()?.name||"No Project"),D($e,`Scenes: ${t(s).scenes??""}`),D(we,`Chapters: ${t(s).chapters??""}`)}),m(e,v),z(),c()}var nt=k('<div class="md:hidden fixed inset-0 z-40 bg-black/40" role="button" tabindex="0" aria-label="Close menu overlay"></div> <aside class="md:hidden fixed z-50 inset-y-0 left-0 w-72 bg-white dark:bg-gray-900 border-r border-gray-200 dark:border-gray-700 p-3"><button class="mb-3 p-2 rounded hover:bg-gray-100 dark:hover:bg-gray-800" aria-label="Close menu">Close</button> <div class="text-sm text-gray-700 dark:text-gray-300"><!></div></aside>',1),lt=k('<aside class="hidden md:flex md:flex-col md:w-60 border-r border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-900"><div class="p-3 text-sm text-gray-700 dark:text-gray-300"><!></div> <div class="mt-auto p-3 text-xs text-gray-500">Sidebar</div></aside> <!>',1);function dt(e,a){Z(a,!1);let n=S();const l=re.subscribe(u=>_(n,u));Q(()=>()=>l()),E();var c=lt(),s=ce(c),v=i(s),d=i(v);ue(d,{}),r(v),P(2),r(s);var p=g(s,2);{var o=u=>{var y=nt(),f=ce(y),b=g(f,2),x=i(b),j=g(x,2),w=i(j);ue(w,{}),r(j),r(b),L("click",f,function(...T){Y?.apply(this,T)}),L("keydown",f,T=>T.key==="Escape"&&Y()),L("click",x,function(...T){Y?.apply(this,T)}),m(u,y)};Je(p,u=>{t(n)&&u(o)})}m(e,c),z()}var ct=k('<div><div class="flex items-start gap-2"><div class="flex-1"> </div> <button class="opacity-80 hover:opacity-100">×</button></div></div>'),vt=k('<div class="fixed z-50 bottom-4 right-4 space-y-2"></div>');function ut(e,a){Z(a,!1);const n=()=>A(We,"$toasts",l),[l,c]=W();E();var s=vt();be(s,5,n,ye,(v,d)=>{var p=ct();let o;var u=i(p),y=i(u),f=i(y,!0);r(y);var b=g(y,2);r(u),r(p),I(x=>{o=ae(p,1,"px-3 py-2 rounded shadow text-white",null,o,x),D(f,t(d).message)},[()=>({"bg-blue-600":t(d).type==="info","bg-green-600":t(d).type==="success","bg-yellow-600":t(d).type==="warn","bg-red-600":t(d).type==="error"})]),L("click",b,()=>Ge(t(d).id)),m(v,p)}),r(s),m(e,s),z(),c()}var ft=k('<div class="min-h-screen flex bg-gray-50 dark:bg-gray-950 text-gray-900 dark:text-gray-100"><!> <div class="flex-1 flex flex-col min-w-0"><!> <main class="p-4"><!></main></div> <!></div>');function jt(e,a){Z(a,!1),Q(()=>{xe().catch(()=>{})}),E();var n=ft(),l=i(n);dt(l,{});var c=g(l,2),s=i(c);st(s,{title:"Loke Cards (Svelte)"});var v=g(s,2),d=i(v);ge(d,a,"default",{}),r(v),r(c);var p=g(c,2);ut(p,{}),r(n),m(e,n),z()}export{jt as component};
